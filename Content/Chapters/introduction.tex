\chapter{Introduction}
\label{sec:introduction-chapter}

\section{The Capacitated Vehicle Routing Problem}
\label{sec:intro-cvrp-problem}

The Capacitated Vehicle Routing Problem (\textbf{CVRP}), first presented in \textcite{dantzig1959},
is one of the most studied combinatorial optimization routing problem.
The CVRP is an NP-hard (in the strong sense) problem which can be considered a generalization
of the well-known Travelling Salesman Problem (TSP),
which is a very well-known problem that asks for the determination
of a Hamiltonian circuit of minimum cost.
The problem can be defined verbally as finding an optimal route for a transportation/distribution/delivery problem
starting from a common point called the depot,
where a homogeneous fleet composed of a fixed number of trucks, subject to capacity constraints,
need to serve customer demands of a single good (i.e. delivery of gasoline to gas stations).
Given as input: a weighted graph, the customer demands and the vehicle capacity,
the problem consists in minimizing the overall travel distance,
while serving all the customers exactly once.

Studying effective solutions methods for the CVRP may lead to tremendous real-world economic
savings for the management of the provision of goods in distribution systems.
Optimal delivery planning can reduce the overall transportation and good costs while
also reducing the waiting time experienced by the customers.
Therefore, studying optimal efficient algorithms and mathematical models for
respectively solving and describing real-world distribution problems, become vital
important for the operational management of a cost-efficient planning processes.

The CVRP belongs to the wider class of problems known as the Vehicle Routing Problems (VRPs).
There are many variations of VRPs proposed in the literature such as
the Vehicle Routing Problem with Time Windows (VRPTW), in which
each customer is associated with a time window in which it can be served,
and many others.
Nonetheless, CVRP remains probably the most central and studied one.
For a more complete survey of the many variations of the VRP problems refer to \cite{toth2014}.

While effective (meta-)heuristic algorithms have been proposed and applied
successfully to many VRP variants to obtain good-enough solutions
in reduced computation time, in this thesis we are mainly concerned
with exact algorithms for solving the CVRP.
Exact algorithms are usually slower than (meta-)heuristics, but given
enough computation time, they can produce a proven optimal solution.
This is achieved by closing the primal-dual bound gap of the objective function.

For a fairly complete set of notions and facts about VRP, we highly suggest
the book \citetitle{toth2014} of \textcite{toth2014}, which
played a central role in writing this introductory chapter.


CVRP is usually defined more rigorously through an Integer Programming (IP) formulation.
The IP formulation is a mathematical tool which can describe combinatorial optimization problems
through the usage of constraints, usually defined with linear inequalities.
In the next section we will present the most common IP formulations for the CVRP, which
are required to understand the content of this thesis.


\begin{comment}
\cite{toth2002}
The distribution of goods concerns the service, in a given time period, of a set of
customers by a set of vehicles, which are located in one or more depots, are operated by a
set of crews (drivers), and perform their movements by using an appropriate road network. In
particular, the solution of a VRP calls for the determination of a set of routes, each performed
by a single vehicle that starts and ends at its own depot, such that all the requirements
of the customers are fulfilled, all the operational constraints are satisfied, and the global
transportation cost is minimized. In this section, we describe the typical characteristics of
the routing and scheduling problems by considering their main components (road network,
customers, depots, vehicles, and drivers), the different operational constraints that can be
imposed on the construction of the routes, and the possible objectives to be achieved in the
optimization process.
The road network, used for the transportation of goods, is generally described through
a graph, whose arcs represent the road sections and whose vertices correspond to the road
junctions and to the depot and customer locations.
\end{comment}

\section{Mathematical formulations}
\label{sec:intro-cvrp-mathematical-formulations}

In this section we present the CVRP through some very well known mathematical formulations.
These mathematical formulation are expressed through (Mixed) Integer Programming (MIP, IP)
models.
We present:
(i) the two-index arc flow formulation presented in \textcite{laporte1983, laporte1985, laporte1986},
(ii) the three-index arc flow formulation presented in \textcite{toth2002},
and (iii) the Set Partitioning (SP) formulation presented in \textcite{balinski1964}.
The first two formulations, traditionally designed
for branch-and-cut algorithms, employ a polynomial number of variables
but use an exponential number of constraints.
The latter formulation, instead, makes use of a polynomial number of constraints,
but uses an exponential number of variables.
Despite the SP formulation being older, in later years thanks to algorithmic advances
and the development of efficient branch-and-price frameworks, it has become the de facto
state-of-the-art core ingredient for solving CVRP problems (see \cite{pessoa2020}).

Before presenting the formulation we first need to define some basic notation
and mathematical quantities that will be used throughout the remainder of the thesis.
\textcite{toth2002, toth2014} provides a comprehensive overview of the mathematical models
for VRP and plentiful taxonomy of VRP variants, both for the directed and undirected case.

\medskip

The CVRP is traditionally described as a node routing problem modeled through a symmetric and complete graph theoretical problem,
where: (i) the vertices of the network represent the customers and the depot,
(ii) the edges represent road interconnections.
Let $G = \Tuple*{V, E}$ denote a \textbf{complete undirected network}, where $V = \Set*{0, 1, \dots, N - 1}$ denotes the set of nodes,
$E = \Set*{e = \Set*{i, j} = \Set*{j, i} \mid \allowbreak i,j \in V, \allowbreak i \ne j}$ the set of edges, and $N$ the number of nodes in the network.
The value $0 \in V$ is used to denote the depot node.
The edge set $E$ has size $|E| = \frac{N (N+1)}{2}$.
For convenience, we define $V_0 = V \setminus \Set*{0}$ to express the set of customers, and $N_0 = N - 1$ to denote the number of customers.
Let $\delta(S)$ with $S \subseteq V$ denote the edges crossing the set $S$ and its complement $\overline{S} = V \setminus S$.
More formally we can express $\delta(S)$ as $\delta(S) = \Set*{ \Set*{i, j} \in E \mid i \in \Expr*{S \cap V}, j \in \Expr*{ \overline{S} \cap V } }$.
For brevity, we also define $\delta(i) = \delta(\Set*{i})$ to denote the set of edges incident to node $i \in V$.
We also define $E(S) = \Set*{e = \Set*{i, j} = \Set*{j, i}\in E \mid i, j \in S}$ denotes the set of edges having both end points in set $S \subseteq V$.

Let $q_{i} \in \R, q_{i} \ge 0$ denote the demand function, which represent the required demand that need to be served for vertex $i \in V$.
For convenience, we fix a fictitious demand for the depot: $q_0 = 0$.
Given a set $S \subseteq V$, we define $q(S) = \sum_{i \in S} q_i$ as the total demand of the set $S$.
Let $d_{ij} \in \R, d_{ij} > 0$ denote the distance function between a pair of nodes  $i, j \in V$.
The loop arcs ${i, i}$ in CVRP are traditionally not allowed, thus we fix $d_{ii} = \infty$.
We assume an Euclidian CVRP problem, i.e. the distance function is symmetric $d_e = d_{ij} = d_{ji}$ and satisfies the triangle inequality $d_{ij} \le d_{ih} + d_{hj}$.
We are also given the total number of identical trucks $K \in \N_+$ and an upper bound $Q \in \R_+$ representing the capacity of each truck.
For convenience of notation, we also define $\mcK = \Set*{1, \dots, K}$ to denote the set of trucks.
Given a set $S \subseteq V_0$, we denote by $r(S)$ as the minimum number of vehicles required to serve all customers $i \in S$.
The value of $r(S)$ can be obtained by solving an NP-hard Bin Packing Problem associated with the CVRP and set $S$.
Often, it is simpler to consider $r(S)$ by replacing it with the trivial lower bound of the Bin Packing Problem \parencite{martello1990}:

\begin{equation}
	r(S) \ge \ceil*{\frac{q(S)}{Q}}
\end{equation}

A route $p$ is a loop-back sequence $p = \Tuple*{i_0, i_1, \dots, i_s}$, with $i_0 = 0$ in which
$\Set*{i_1, \dots, i_s} \subseteq V_0$ customers are visited.
The route $p$ has a travel cost of $c_p = c(p) = \sum_{j=0}^s c_{i_j,i_{j+1}}$.
A feasible solution to the CVRP problem consists of \textbf{exactly} $K$ routes (or circuits) associated with each vehicle starting from the depot node.
Some variants of the basic version of the CVRP, not considered in this thesis, allows using only a subset of the total available vehicles,
or consider a heterogenous fleet characterized by different capacities $Q_1, \dots, Q_k$.
In classic CVRP, each customer is visited exactly once, and the sum of the customer demands visited in each tour does not exceed the vehicle capacity $Q$.
An optimal solution to the CVRP is a feasible solution which minimizes the sum of the overall edge weights across all the tours.
To simplify the symmetric formulations, we assume that routes must visit at least two customers.
This assumption avoids some edge cases in modeling when handling single-customer routes.
In the remainder of the section we introduce the two most common IP mathematical formulations for the CVRP.

The TSP can be considered a special case of CVRP where $Q \ge q(V)$ and $K = 1$.
Therefore, all the relaxations and many results obtained for the TSP are valid, or at least extendable, to the CVRP.

\subsection{The two-index arc flow formulation}
\label{sec:intro-cvrp-two-index-flow-formulation}

The two-index arc flow formulation was first presented in \cite{laporte1983, laporte1985} for the symmetric case,
and later generalized to the undirected case in \cite{laporte1986}.

As already mentioned in the introduction,
to avoid edge cases in modeling we assume a CVRP problem where
vehicles must visit at least two customers,
We define a set of binary variables $x_e \in \Set*{0, 1}$ to indicate if any vehicle traverses
edge $e = \Set*{i, j} = \Set*{j, i} \in E$ in the optimal solution.
Notice that it could be possible to impose $x_{0j} \in \Set*{0, 1, 2} \quad \forall j \in V_0$
to allow for single customer routes.
There are $O(N^2)$ number of binary variables in the model.

The two-index arc flow formulation is usually solved through a branch-and-cut framework.
We finally give the two-index flow description as an Integer Programme (IP) model:



\begin{align}
	\min_{x} \quad z_\mt{2F}(x) & = \sum_{e \in E} d_e x_e \label{eq:two-index-flow-obj-func}                                                                                     \\
	                            & \sum_{e \in \delta(i)} x_e = 2                                  & \quad \forall i \in V_0 \label{eq:two-index-flow-two-edges-incident-per-customer} \\
                                & \sum_{e \in \delta(0)} x_e = 2 K                                           & \label{eq:two-index-flow-two-k-edges-incident-in-the-depot-node}                  \\
	                            & \sum_{e \in \delta(S)} x_e \ge 2 r(S)                           & \quad \forall S \subseteq V_0,\ |S| \ge 1 \label{eq:two-index-flow-ccc}           \\
	                            & x_e                   \in \Set*{0, 1}                                & \quad \forall e \in E \label{eq:two-index-flow-x-mip-var-bounds}
\end{align}

where $z_\mt{2F}(x)$, as defined in \eqref{eq:two-index-flow-obj-func}, is the objective function which aim to minimize the overall routing cost (travel time).
Constraint \eqref{eq:two-index-flow-two-edges-incident-per-customer} is the degree constraint which imposes flow conservation: exactly two incident edges must be picked for each customer.
Constraint \eqref{eq:two-index-flow-two-k-edges-incident-in-the-depot-node}, is the degree constraint at the depot, it forces that exactly $2K$ incident edges at the depot are picked, thus forcing exactly $K$ routes to be constructed.
Constraint \eqref{eq:two-index-flow-ccc}, are the so-called Capacity Cut Constraints (CCC), they function both as:
(i) Subtour Elimination Constraints (SECs), by imposing connectivity of the solution by avoiding the formation of spurious unconnected subtours,
(ii) and as a capacity constraint, by imposing that any customer set $S$ is crossed by a number of edges not smaller than $r(S)$.
Recall that, $r(S)$ represents the minimum number of vehicles needed to serve all customers in set $S$,
also, $r(S)$ always satisfies $r(S) \ge 1$ for non-trivial CVRP instances.

It was shown in \textcite{cornuejols1993}, that it is possible to replace $r(S)$ in constraint
\eqref{eq:two-index-flow-ccc}, with the much simpler Bin Packing Problem lower bound $\ceil*{q(S) / Q}$
thus obtaining the following inequality:

\begin{equation}
    \sum_{e \in \delta(S)} x_e \ge 2 \ceil*{\frac{q(S)}{Q}}   \quad \forall S \subseteq V_0, |S| \ge 1 \label{eq:two-index-flow-ccc-bpp-lower-bound}                                                             \\
\end{equation}

Traditionally, the CCC constraints of \eqref{eq:two-index-flow-ccc}, are usually transformed in the so called Generalized Subtour Elimination Constraints (GSEC),
by means of the degree constraints \eqref{eq:two-index-flow-two-edges-incident-per-customer}\eqref{eq:two-index-flow-two-k-edges-incident-in-the-depot-node}:

\begin{equation}\label{eq:cvrp-2flow-gsec}
	\sum_{e \in E(S)} x_{ij} \le |S| - r(S) \quad \forall S \subseteq V_0,\ |S| \ge 1
\end{equation}.

where again $r(S)$ may be replaced by the trivial Bin Packing Problem lower bound $\ceil*{q(S) / Q}$.

The GSEC avoid the formation of spurious unconnected subtours, and impose that at least $r(S)$ edges leave set $S$.
The number of GSEC (or CCC) inequalities appear in exponential number in the two-index formulation model,
thus making a direct solution of the linear programming relaxation impracticle.
To overcome this issue, it is possible to avoid adding the GSEC inequalities staticaly in the model.
Instead, an appropriate cutting-plane algorithms and separation procedures may be employed to generate dynamically only the required
GSEC constraints during the running time of the branch-and-cut algorithm.

Another approach is to avoid the usage of the exponential number of SECS entirely.
This is the approach taken by the so-called compact models (see \cite{miller1960, christofides1979, desrochers1991}).
These models make use of a polynomial number of constraints.
Unfortunately these compact formulations are known to lead to significantly weaker linear relaxations.
It has been known for quiet some time, that the SECs are very strong for the TSP polytope, so strong in fact, that are facet-defining.
However, the presence of facet-defining inequalities hold only for the TSP, since due to the more complex structure of the CVRP,
little satisfactory results have been obtained in studying the polyhedral characteristics for the standard CVRP, see \textcite{campos1991, cornuejols1993}.


\subsection{The three-index arc flow formulation}
\label{sec:intro-cvrp-three-index-flow-formulation}

When modeling more "colorful" variations of the CVRP, the two-index arc flow model falls shorts in providing sufficient descriptive power.
For example, the simple CVRP variant where the fleet of trucks is heterogenous and characterized by capacities $Q_1, \dots, Q_K$,
cannot be described with the two-index arc flow formulation, since there's no clear one-to-one mapping on which truck crosses an edge $e \in E$.
The three-index arc flow formulation fixes this issue.
This formulation instead, compared to the two-index version, makes use $O(N^2 K + N K)$ binary variables.
A set of binary variables $x_{ek} \in \Set*{0, 1}, e = \Set*{i, j} \in E, k \in \mcK$ is now used encode whether vehicle $k$ traverses edge $e$.
Another set of binary variables $y_{ik} \in \Set*{0, 1}, i \in V, k \in \mcK$ is also employed to model whether truck $k$ serves customer $i$.

It has to be noted however, that there's a downside in employing the three-index arc flow formulation to model standard homogenous truck CVRPs which the two-index version does not suffer.
This new formulation may, in fact, lead to symmetric solutions which are simply obtained by any permutation of the identity $k \in \mcK$ of each truck.

In any case, we can give the IP model as:

$$
\mt{K}
$$

\begin{align}
	\min_{x, y} \quad z_\mt{3F}(x, y) & = \sum_{k \in \mcK} \sum_{e \in E} d_{e} x_{ek} \label{eq:three-index-flow-obj-func}                                                                                                                               \\
	                                  & \sum_{k \in \mcK} y_{ik} = 1                                                         & \quad \forall i \in V_0                                              \label{eq:three-index-flow-all-customers-visited}      \\
	                                  & \sum_{k \in \mcK} y_{0k} = K                                                         & \label{eq:three-index-flow-tour-starts-and-ends-at-depot}                                                                   \\
	                                  & \sum_{e \in \delta(i)} x_{ek} = 2 y_{ik}                                          & \quad \forall i \in V,\ \forall k \in \mcK \label{eq:three-index-flow-force-visited-customer-if-flow}                          \\
	                                  & \sum_{i \in V} q_i y_{ik} \le Q                                                   & \quad \forall k \in \mcK \label{eq:three-index-flow-force-resource-upper-bound}                                                \\
	                                  & \sum_{e \in \delta(S)} x_{ek} \ge 2 y_{hk}                                        & \quad \forall h \in S,\ \forall S \subseteq V_0,\ |S| \ge 2,\ \forall k \in \mcK \label{eq:three-index-flow-secv1} \\
	                                  & x_{ek}                   \in \Set*{0, 1}                                          & \quad \forall e \in E,\ \forall k \in \mcK             \label{eq:three-index-flow-x-mip-var-bounds}                            \\
	                                  & y_{ik}                    \in \Set*{0, 1}                                         & \quad \forall i \in V,\ \forall k \in \mcK  \label{eq:three-index-flow-y-mip-var-bounds}
\end{align}

where $z_\mt{3F}(x, y)$, as defined in \eqref{eq:three-index-flow-obj-func}, is the objective function to be minimized (i.e. the overall travel distance).
Constraint \eqref{eq:three-index-flow-all-customers-visited} forces all customers to be served exactly once.
Constraint \eqref{eq:three-index-flow-tour-starts-and-ends-at-depot} forces all the truck tours to start at the depot and end at the same spot.
Constraint \eqref{eq:three-index-flow-force-visited-customer-if-flow} binds the $y_{ik}$ variables to the corresponding $x_{ijk}$ variables, by ensuring that if a truck's route passes through a vertex, then the corresponding node is marked as visited.
Constraint \eqref{eq:three-index-flow-force-resource-upper-bound} is the resource upper bound constraint and it ensures that the demand served by each truck does not exceed the truck capacity.
Constraints \eqref{eq:three-index-flow-secv1} are the Generalized Subtour Elimination Constraints (GSECs), they impose the connectivity of the route and are used to avoid the formation of spurious unconnected subtours.
Finally, Constraints \eqref{eq:three-index-flow-x-mip-var-bounds}, \eqref{eq:three-index-flow-y-mip-var-bounds} bound and force integrality for the IP variables.

Constraint \eqref{eq:three-index-flow-secv1} may be replaced in an equivalent form with traditional (non generalized) TSP subtour elimination constraints (see \textcite{fisher1981}):

\begin{equation}\label{eq:three-index-flow-secv2}
	\sum_{e \in E(S)} x_{ek} \le |S| - 1 \quad \forall S \subseteq V_0, |S| \ge 2,\ \forall k \in \mcK
\end{equation}

Since the number of (G)SECs is exponential in the number of nodes $N$, they are usually not inserted statically in the model but are generated lazily within the running time of the resolution process.

The three-index arc flow model generalizes the two-index version.
In fact, the two-index arc flow model may be viewed as a special case of the three-index by defining:

\begin{equation}
    x_e = \sum_{k \in \mcK} x_{ek} \quad \forall e \in E
\end{equation}



\begin{comment}
There's an important observation to be made on constraint \eqref{eq:three-index-flow-tour-starts-and-ends-at-depot}.
By using the equality sign, we're forcing solutions to use all the available $K$ trucks, even though better solutions making use of less trucks may exist.
In our case, we decided to fix the number of routes in the CVRP formulation since it seems that this is the most agreed contention in the literature.
Some authors, instead, prefer a different CVRP formulation, by not fixing the number of routes, and by essentially using a less-than-sign in place of the equality.

The three-index flow formulation is usually solved through the usage of a standard Branch \& Cut framework approach.
Modern CVRP solvers, instead, rely on a different mathematical formulation and employ a  mostly Branch \& Price based-approach (although hybridization are also possible).
The Set Partitioning (SP) formulation is the main starting point employed by Branch \& Price solvers.
In this thesis we will mostly concentrate on Branch \& Price approaches for the CVRP.
In the next subsection we will introduce the set partitioning formulation, and in the remainder of the section
we will briefly introduce the key ingredients of modern Branch \& Price solvers.

\end{comment}

\subsection{The Set Partitioning (SP) formulation}
\label{sec:intro-set-partition-formulation}

The Set Partitioning (SP) formulation, sometimes also called Path Flow formulation, is an extended formulation, which was originally presented in \textcite{balinski1964},
works substantially differently from the two/three-index arc flow formulation or many other commonly encountered IP models.
The SP formulation uses a very small number of constraints while offloading all the model complexity to an exponential number of binary variables.


The SP formulation can be viewed as a Dantzig-Wolfe decomposition \parencite{dantzig1960}
and commodity aggregation \parencite{desaulniers1998}
of the three-index arc flow formulation.
Let $P = \Set*{p \mid p\ \text{is a single-truck feasible route}}$ be the set of all feasible routes.
Let $\lambda_p \in \Set*{0, 1}$ be a binary variable indicating whether route $p$ is selected.
Let $a_{ip} \in \Set*{0, 1}$ be a "static encoding" (binary coefficient) for a route $p$,
i.e. $a_{ip} = 1 \texttt{ if } i \in p = \Tuple*{0, i_1, i_2, \dots, i_s}$,
namely if vertex $i \in V$ is visited (or covered) by route $p$.

We recall that $c_p = c(p)$ represents the cost of a feasible route $p \in P$, which can be trivially computed in $O(N)$.
The SP model forces $K$ routes $\Tuple*{p_1, \dots, p_K} \in P^K$ to be included in the optimal solution.
The SP is described through an Integer Programme (IP) formulation:


\begin{align}
	\min_{\lambda} \quad z_\mt{SP}(\lambda) & = \sum_{p \in P}  c_p \lambda_p \label{eq:set-partitioning-obj-func}                                                                                                                                           \\
	                                        & \sum_{p \in P}  a_{ip} \lambda_p = 1                                & \quad \forall i \in V_0                                              \label{eq:set-partitioning-customers-visited-by-exactly-one-route} \\
	                                        & \sum_{p \in P} \lambda_{p} = K\label{eq:set-partitioning-K-routes}                                                                                                                                             \\
	                                        & \lambda_p                    \in \Set*{0, 1}                         & \quad \forall p \in P \label{eq:set-partitioning-lambda-mip-var-bounds}
\end{align}

where, $z_\mt{SP}(\lambda)$, as defined in \eqref{eq:set-partitioning-obj-func} is the objective function to be minimized (i.e. the overall travel distance).
Constraint \eqref{eq:set-partitioning-customers-visited-by-exactly-one-route} forces each customer to be covered by exactly one route.
Constraint \eqref{eq:set-partitioning-K-routes} enforces that exactly $K$ routes are selected.
Finally, constraint \eqref{eq:set-partitioning-lambda-mip-var-bounds} is the bounding and integrality constraints for binary variables $\lambda_p \ \forall p \in P$.

As one may guess, due the exponential number of binary variables, the SP formulation cannot be instantiated nor directly solved.
However, a variant of the SP formulation can be tackled efficiently by column generation approaches embedded inside a Branch \& Price framework.
Branch \& Price frameworks and column generation have been shown to work remarkably well for solving routing problems.


As, \textcite{toth2002} points out, if the distance matrix satisfies the triangle inequality,
than it is possible to rewrite the SP formulation into a totally equivalent Set Covering (SC) formulation
by substituting the equality constraints \eqref{eq:set-partitioning-customers-visited-by-exactly-one-route} in favor of the simpler inequlities:

\begin{equation}\label{eq:set-covering-customers-visited-by-exactly-one-route}
    \sum_{p \in P}  a_{ip} \lambda_p \ge 1  \quad \forall i \in V_0
\end{equation}

Under the triangle inequality assumption, any feasible solution for the SP formulation is also feasible for the SC formulation.
Transforming the SP to the SC formulation vastly shrinks (halves) the size of the dual solution space.
The SP has two main advantages.
First, its linear relaxation provides excellent lower bounds \parencite{bramel1997}.
Second, it can handle many VRP variants even described
through very complex constraints
since their definitions are captured within the definition of the set $P$ itself.
In fact, the SP formulation can be used to model a wide variaty of VRP classes,
since the constraints that decides whether a route is feasible or not are handled
by the pricer algorithm.


In the next sections we will introduce the Branch \& Price framework and the column generation approach, key components employed in modern state-of-the-art CVRP solvers.



\section{Resolution methods}
\label{sec:intro-resolution-methods}

\subsection{Branch and Cut}
\label{sec:intro-branch-and-cut}

\mytodo{Write this section or merge it inside the "Solving the pricing problem"}

\subsection{Branch and Price}
\label{sec:intro-branch-and-price}

Branch-and-price frameworks are in essence a branch-and-bound scheme, i.e. making use of a search tree, that originates when solving the SP formulation for vehicle routing problems.
Compared to more traditional Branch \& Cut frameworks, their primary focus is the usage of a column generation technique for improving the dual bound, see \textcite{righini2008}.
Branch and Price frameworks were first applied successfully in \textcite{gilmore1961} to the Cutting-Stock problem.
A BPC is in essence a branch-and-bound algorithm where lower bounds are computed by column generation (CG) and cutting-planes are added to strengthen the linear relaxations.


\subsubsection{Column generation and the Pricing Problem}
\label{sec:column-generation-and-pricing-problem}

The purpose of the column generation procedure is to generate routes for the SP formulation lazily on demand.
Consider the Master Problem (MP) of the set partitioning formulation defined by relaxing the integrality constraints:

\begin{align}
	\min_{\lambda} \quad z_\mt{MP}(\lambda) & = \sum_{p \in P}  c_p \lambda_p \label{eq:mp-obj-func}                                                                                                                             \\
	                                        & \sum_{p \in P}  a_{ip} \lambda_p = 1                  & \quad \forall i \in V_0                                              \label{eq:mp-customers-visited-by-exactly-one-route} \\
	                                        & \sum_{p \in P} \lambda_{p} = K\label{eq:mp-K-routes}                                                                                                                               \\
	                                        & 0 \le \lambda_p \le 1                                  & \quad \forall p \in P \label{eq:mp-lambda-mip-var-bounds}
\end{align}


When solving the MP, at each iteration of the simplex algorithm we seek for a non-basic variable (i.e. column) to price out and enter the basis.
This is achieved by evaluating the dual variables $\pi \in \R$ associated with constraints \eqref{eq:mp-K-routes}, \eqref{eq:mp-customers-visited-by-exactly-one-route}.
Due to the huge size of the set of routes $P$, it is computationally intractable to evaluate numerically the dual variables $\pi \in \R$.

\medskip

Therefore, a valid approach taken by Branch \& Price framework consists of considering only a small subset of columns $\mcP \subseteq P$, obtaining the following linear program relaxation:

\begin{align}
	\min_{\lambda} \quad z_\mt{RMP}(\lambda) & = \sum_{p \in \mcP}  c_p \lambda_p \label{eq:rmp-obj-func}                                                                                                                              \\
                                             & \sum_{p \in \mcP}  a_{ip} \lambda_p = 1                   & \quad \forall i \in V_0                                              \label{eq:rmp-customers-visited-by-exactly-one-route} \\
	                                         & \sum_{p \in \mcP} \lambda_{p} = K\label{eq:rmp-K-routes}                                                                                                                                \\
	                                         & 0 \le \lambda_p \le 1                                        & \quad \forall p \in \mcP \label{eq:rmp-lambda-mip-var-bounds}
\end{align}

which takes the name of Restricted Master Problem (RMP).

In BAP frameworks, we seek to solve the so-called Pricing Problem (PP) defined as:

\begin{equation}
	{c^\star_p} = \min_{p \in P} \Set*{ \bar{c_p} = \sum_{(i, j) \in E} \Expr*{d_{ij} - \frac{\pi_i + \pi_j}{2}} a_{ijp}  }
\end{equation}

where $\bar{c_p}$ denotes the reduced cost of a route $p \in P$, and $c^\star_p$ is the reduced cost of the optimal route $p^\star \in P$ that leads to the best dual bound improvement.
Any $p \in P$ which satisfies $\bar{c_p} < 0$ is a valid column which can enter the basis of the RMP.
The Branch \& Price solver needs to smartly manage the set $\mcP \subseteq P$, which stores in a pool.
It is responsibility of the BAP framework to efficiently manage which routes to preserve or drop within the pool during the running time of the resolution process.

The resolution method, or algorithm, used to solve the PP is usually called "oracle" or "pricer" in the literature.
The oracle needs to solve the PP which, due to the definition of the set $P$, coincides with solving an Elementary Shortest Path Problem with Resource Constraints (ESPPRC) over a directed graph with weights $\bar{c_{ij}} = d_{ij} - \frac{1}{2} \pi_i - \frac{1}{2} \pi_j$, where the source and sink vertex collapse at the depot node.

The column generation is an iterative algorithm which alternates between two phases \parencite{desaulniers2018}:
\begin{enumerate}
    \item The simplex algorithm for solving the RMP, which is characterized by one or more pivot operations.
    \item One or several iterations of the Pricing Problem (PP) solved by invoking the pricer algorithm.
        The simplex algorithm invokes the pricer to verify whether other pivot operations are possible for improving the dual bound.
        The pricer algorithm is usually external, and lives in a separate module compared to the branch-and-price code.
\end{enumerate}

The column generation procedure stops when no more negative reduced cost routes exist.

Note that, the BAP solver need not to solve the PP optimally at each iteration of the simplex algorithm.
To improve the dual bound, it is usually enough to find any $p \in P$ achieving $\bar{c_p} < 0$, which allow the usage of heuristic algorithms especially during the very first few iterations, where finding good reduced cost columns is surprisingly easy.
Branching occurs when either: (i) the optimal solution of the PP, $p^\star$, achieves $c^\star_p \ge 0$ (non-negative solution) and $\exists p \in \mcP \mid \lambda_p \notin \Set*{0, 1}$; (ii) the column generation procedure tails off, i.e. the gained dual bound improvements compared to the running time to generate a column become suboptimal.

The subproblem can be seen as a variant of the elementary shortest path problem with resource constraints (ESPPRC).


\subsection{Branching and Cut Generation within BAP frameworks}
\label{sec:intro-branching-and-cut-generation-within-bap-frameworks}

In order to satisfy the integrality constraints for the SP formulation, solving the RMP at the root node
is almost always not enough.
Therefore, a search-tree and a branching scheme is employed to seek for the optimal integral solution $\lambda^\star_p \in \Set*{0, 1} \quad \forall p \in P$.
Although non strictly-necessary, modern BAP also use cut generation procedures to efficiently improve the dual bound and improve convergence speed.
Modern BAP frameworks are in fact a hybridization between a BAP and a BAC framework, making them a Branch \& Cut \& Price (BCP) frameworks.

\medskip

Unfortunately, branching and cut generation in BCP frameworks is more delicate compared to more traditional BAC frameworks due to the presence of the pricing problem.
Depending on the branching and cut generation schemes employed, two classes of inequalities are possible: \textbf{robust} versus \textbf{non-robust} inequalities.

A \textbf{robust} inequality is an inequality which can be safely added to the RMP without altering the structure of the set of feasible paths $P$.
That is, robust inequalities do not require explicit modeling in the PP formulation and instead manifest their contribution directly in the dual variables $\pi$.
An oracle, therefore, after the introduction of a robust inequality in the RMP, needs to solve the same ESPPRC problem but with slightly different weights associated on each edge.

A \textbf{non-robust} inequality, instead, is much harder to handle since it changes the structure of the set of feasible paths $P$.
Non-robust inequalities may in general be quite strong but, unfortunately, require explicit modeling and support within the oracle.
These types of inequalities can drastically complicate the pricing problem, trading better dual improvements for increased column generation times.
Therefore, their usage must be assessed on a case-by-case basis.

When a violated inequality in the two/three-index formulation is found, it is decomposed at runtime and introduced in the master problem.

In this thesis we will mostly concentrate on branching and cut generation schemes which make use of \textbf{robust} inequalities.
Refer to \textcite{desaulniers2011} for an introduction in cutting planes for BAP algorithms.

Many branching schemes for the CVRP are mere extension of the one used for the TSP.
Probably, the most simple and known branching scheme in the \textbf{branching on arcs} proposed in \textcite{christofides1969a},
and later re-adapted in different forms in \textcite{fisher1994a, miller1995}.
Also, some reduction and dominance rules may be employed to remove some arcs
which can be proved that they cannot belong to an optimal solution,
thus it is possible to branch with a single descendant node to eliminate
a good portion of the solution space.


First attempts in proposing valid inequalities for the CVRP,
with the aim to improve the linear relaxation,
were obtained by generalizing constraints for the TSP, see \textcite{naddef1993}.

Some non-robust cuts were also deployed for the CVRP,
showing that they can be effectively used if they are separated
carefully, by taking into consideration the aggravation of the pricing problem.
Major contributions in the non-robust cuts domain are: the subset row inequalities in \textcite{jepsen2008a},
the strong capacity inequalities in \textcite{baldacci2008}.


\subsubsection{Families of Cuts}

As is done in \textcite{toth2014}, families of valid inequalities for the CVRP can
be separated in different families.

\begin{itemize}
    \item \textbf{TSP-Related Valid inequalities}.
        \textcite{naddef1993} showed that it is possible to re-adapt (by putting into a tight triangular form)
        every valid constraint for the symmetric TSP to the CVRP.
    \item \textbf{Capacity Constraints}
    The capacity constraints can be expressed in the form $\sum_{e in \delta(S)} x_e \ge 2 r(S) \quad \forall S \subseteq V_0, |S| \ge 2$.
    Depending on how $r(S)$ is computed, the set of constraints take different names.
    If $r(S) = \sum_{i \in S} q_i / Q$, we have the so-called fractional capacity inequality.
    If $r(S) = \ceil*{\sum_{i \in S} q_i / Q}$, we have the so-called rounded capacity inequality.

\item \textbf{Multistar Inequalities}, proposed in \textcite{araque1990}.
    \textcite{letchford2002} propose extended version of inequalities for this family of cuts.
    The idea lies in first computing an upper bound on the value of $x(E(S))$, then
    for each value of $x(E(S))$ an upper boun on the $x(\delta(S) \cap \delta(T))$.
    The related inequalities called generalized large multistar inequalities were proposed by \textcite{gouveia1995}.
\end{itemize}

\subsection{Solving the Pricing Problem}
\label{sec:intro-solving-the-pricing-problem}

\mytodo{Write this section or merge it}

The label-setting algorithm work by label construction and propagation from node to node.
The dominance rules in the label-setting algorithm allows the oracle
to efficiently prune the search space by ignoring dominated labels, thus speeding
up the resolution process tremendously.
The dominance criteria was introduced in \cite{feillet2004}.

In order to simplify the pricing problem further,
some authors started to propose to relax the elementarity condition
to speed up the convergence of the label-setting algorithm, worsening however, the dual improvement.
It is in fact possible to drop the elementarity constraints, only if, the BAP framework supports
branching on the edges of the original three-index flow formulation.
Notable contributions in relaxing the elementarity constraints include:
(i) the q-route relaxation suggested in \textcite{christofides1981},
(ii) a state-space relaxation procedure suggested in \textcite{christofides1981a},
(iii) shortest path relaxation suggested in \textcite{desrosiers1984},
(vi) generalizion to $k$-cycle elimination in \textcite{irnich2006}.

The first BCP algorithm, using full elementarity routes, by not relaxing the elementary
condition, was done in \cite{chabrier2006},
but, general k-cycle elimination algorithms for the pricing problem, have since not been studied
in great details.

\subsection{Shortest Path Problem with Resource Constraints}
If there are no negative cost cyles, e.g. when the reduced cost variables are positive $\bar{c_{ij}} \ge 0$,
the ESPPRC problem is solvable in polynomial time, since the elementarity conditions are guaranteed
to be satisfied in this case.
In this particular case, some authors have proposed efficient methods to tackle this case:
\cite{beasley1989}, \cite{carlyle2008}, \cite{dumitrescu2003}, \cite{muhandiramge2009}.
These proposed approaches work under the assumption that no negative cost cycle is present,
and use lagrangian relaxation to relax the capacity constraints.


\subsection{Elementary Shortest Path Problem with Resource Constraints}
In the case where the network may be contain negative cost cycles, the
elementarity condition must be explicitely modeled, or relaxed, in order
to obtain reasonable dual bound solutions for the CVRP.
\textcite{feillet2004} proposes a dynamic programming algorithm where
the elementary property is handled through the usage of an additional resource
bound to each node.
\textcite{righini2006} proposes a bi-directional dynamic programming algorithm to solve the ESPPRC.


\subsection{Obtaining Integer Solutions}

Through: traditional branch and bound where branching is done on an arc or a hyperplane in the original space, or by using enumeration.
The enumeration approach was proposed by \textcite{baldacci2008} in where they prove it to be very successful when applied to the CVRP.


\begin{comment}
\cite{jepsen2011}
The other method is enumeration which has proven to be very successful
for both cvrp[1] and vrptw[3]. In enumeration an upper bound U B and
a lower bound LB are used. From reduced cost fixing of a binary variable
it is know that any non basic column with a reduced cost strictly greater
than the gap ub âˆ’ lb can not be part of an integer solution which is an
improvement of the current solution. This complete set of columns can be
found by solving an espprc using the dominance rule in proposition 5 and
bounding functions. Once we have added the columns with reduced cost less
than or equal to the gap the resulting problem can be solved as an integer
optimization problem.
\end{comment}

\section{Literature Review}
\label{sec:intro-literature-review}

\mytodo{Write this section, by integrating the literature as I read it}


\textcite{dantzig1959} propose for the first time the CVRP problem,
followed a few years later from \textcite{clarke1964} proposing
an effective greedy heuristic algorithm.
In the last 60 years, a huge number of contributors in
the operations research community have studied and proposed many
mathematical models, and algorithms (both exact and (meta-)heuristic)
for solving the VRP.
Up to the late 1980s, the exact approaches for tackling the CVRP was
based on tree-search algorithm employing branch-and-bound schemes
(see \textcite{christofides1969a, christofides1981, laporte1986}),
sometimes employing Lagrangian duality relaxation (see \textcite{fisher1994a, miller1995}),
or additive approaches (see \textcite{fischetti1994a, hadjiconstantinou1995}).

From the 1980s to the first 2000s, some authors applied branch-and-cut
algorithms to the VRP.
\textcite{laporte1985}, proposes the two-index arc flow formulation
and a branch-and-cut algorithm to solve it.
Later \textcite{augerat1995a}, proposes a branch-and-cut schemes
employing extra valid inequalities.
Later, \textcite{lysgaard2004}, proposes a new and more modern separation procedures for
the valid inequalities known at the time.
Other notable branch-and-cut-price based contributions
can be found in \textcite{araqueg1994, augerat1995, achuthan1996, blasum2000, ralphs2003, achuthan2003, baldacci2004}.
These works based on branch-and-cut frameworks, showed that CVRP instances, even with small number of customers (less than 100) proved
to be very challenging to solve exactly.


One of the very few first attempts of applying
the SP formulation and a column generation scheme can
be attributed to\textcite{desrosiers1984, agarwal1989}.
These authors, showed that the column generation scheme proved
very satisfactory to solve the VRPTW under tight constraints,
but did not achieve satisfactory results for the CVRP.
Therefore, until the first 2000s, the branch-and-cut approaches were
deemed to be the best approach for solving the CVRP.
In \citeyear{desrochers1992}, \citeauthor{desrochers1992} proposed the dynamic programming
based label setting algorithm.
This algorithm still constites the major core component
in modern BPC schemes to efficiently solve the pricing problem.
\textcite{kohl1999}, later generalized in \cite{desaulniers2008}, introduce the
2-paths inequalities, and were one of the first attemps to integrate
cutting-planes within the BAP framework for solving the CVRP.
One of the major breakthrough in column generation and VRP research
was obtained in \textcite{fukasawa2006}, which were the
first authors to propose a branch-and-cut-and-price (BCP) algorithm,
embedding a powerful robust-cuts based cutting-plane approach
typically found in BAC algorithms.
\citeauthor{fukasawa2006} integrated the cutting-planes proposed in \cite{lysgaard2004},
and the column generation considered only q-routes without $k$-cycles.
\textcite{fukasawa2006} was able to solve all CVRP instances up to approximately 100 customers.
Since the work of \citeauthor{fukasawa2006} until now, column generation
and the label-setting algorithm have been the defacto procedures
of modern and efficient VRP solvers.
Later, \textcite{baldacci2008}, proposed a slightly different approach w.r.t. \citeauthor{fukasawa2006}.
They employ a column generation considering elementary columns and some more inequalities.
A bounding procedure is employed to quickly
improve the dual bound while drastically reduce the number
of pricing iterations and the columns that needs consideration,
Instead of branching, they use full enumeration of the candidate
routes and solve the problem at the root node by employing a MIP solver.
\textcite{pessoa2008a} improves over the work of \citeauthor{fukasawa2006}.
\textcite{baldacci2011} proposed the ng-routes, a very effective
partial (soft) elementarity constraint
to tradeoff the elementarity condition (i.e. good dual bound in pricing)
for a simpler pricer problem.
The ng-routes can be embedded inside the label-setting algorithm, and
it is another core ingredient of modern VRP solver.
\textcite{ropke2012} revisits the work \citeauthor{fukasawa2006} and applies
the ng-routes relaxation.
\textcite{contardo2014} proposes an effective enumeration schemes and employ the ng-routes effectively,
and was able to solve CVRP instances made of 151 customers.
Finally, a modern BCP was proposed in \textcite{pecin2017}, which
proposed the non-robust limited memory subset row cuts \parencite{pecin2017a}.
By using a bidirectional label setting algorithm, a modern dual smoothing and enumeration
approach and the ng-routes relaxation, they were able to solve CVRP
instances made of 200 customers.
At the day of writing, \textcite{pessoa2020a} is the current state of the
art BCP framework based on column generation with ng-routes relaxation
for solving the CVRP problem.






\begin{comment}
\cite{jepsen_branch-and-cut_2011}

Before 1980 very few exact algorithms for cvrp and vrptw had been
proposed, but in the early 1980s two new exact methods where proposed.
From this point the history of exact methods for cvrp and vrptw can
be divided into three phases. The first phase was the introduction of the
Set Partition and the development of Branch-and-Cut-and-Price (bp) algo-
rithms using a relaxed pricing problem. The second was the development of
Branch-and-Cut (bac) algorithms. In the current phase the pricing problem
is no longer relaxed and cuts in the master problem of the Branch-and-Cut-
and-Price algorithms is used. The first two phases where started at the same
point in time and there is still development on the algorithms in the context
of cvrp and vrptw. The algorithms from these two phases are also used
on several other variants of the Vehicle Routing Problem. The third phase
was started in the middle of the 2000s and the algorithms from this phase
are currently the best overall performing algorithms.
\end{comment}

\section{Thesis Contributions}
\label{sec:intro-thesis-contributions}

One of the major problems of current state-of-the-art CVRP solvers
is that they are usually developed and tuned through the use of historical
benchmark instances.
The major historical test instances are classified in different sets (or families), and
they are usually referred in the literature through a single upper case letter.
We here summarize the core sets proposed by the operations research community for the CVRP problem:
(i) set E is proposed in \textcite{christofides1969} and contains no description about how the instances were generate,
(ii) set M is proposed in \textcite{christofides1979} and it is obtained by merging together some instances from the E set,
(iii) set F is proposed in \textcite{fisher1994} and it obtained from an actual distribution problem of groceries in the city of Ontario,
finally (iv) sets A, B, P are proposed in \textcite{augerat1995} and are generated artificially: A is random, B is clustered, P generated from A,B,E by changing capacities.
Another popular test set is the one proposed in \textcite{golden1998},
which contains large scale instances ranging from 200 to 480 customers,
generated programmatically following concentric geometric figures.

These benchmark instances suffer from being either too homogeneous, or too artificial,
while not covering the main characteristics found in current real-world application problems.
In the work of \textcite{uchoa2017}, for example, they propose
a new more modern and diverse set of benchmark instances (called set X, ranging from 100 to 1000 customers)
to replace the historical used ones, since those have become "rather easy" for modern algorithms.
Despite this recent effort in proposing new instances for the CVRP, the scientific community
has yet to fully agree on a common denominator for new more-modern benchmark set, and therefore,
the common and historical instances played (and still remains) the main central test-bed for comparing
and assessing the performance of CVRP contributions.

These historical instances are usually characterized with stringent vehicle capacities
which consequently give rise to optimal solutions characterized by small routes, each visiting few customers.
In practice, the vehicle capacity is rarely the bottleneck and
real-world modern distribution problems are instead characterized by much longer routes.
When solving the pricing problem, it has been shown that the performance of the dynamic labeling algorithm
tends to drop as the length of the routes increases,
while at the same time,
the performance of branch-and-cut algorithms seem to improve in this domain \inlinetodo{Citation needed}.

The goal of the thesis lies in studying the feasibility and competitiveness of a
branch-and-cut algorithm, implemented through a commercial MIP software package,
for solving the pricing problem.
The objective is to empirically evaluate the performance of the proposed
branch-and-cut framework against the state-of-the-art labeling
algorithm, while empirically measuring how the two frameworks behave
as the lengths of the route they need to generate increases.
\cite{jepsen2014} proposed a branch-and-cut framework for solving the pricing problem.
In their work, \citeauthor{jepsen2014} showed that, despite the dynamic programming algorithm
turned out to be much faster in many instances, the BAC framework exhibited
better performance for some larger instances; proving that
a BAC framework could complement the dynamic programming algorithm for solving the PP.
This thesis stems from the original work \citeauthor{jepsen2014}.
The objective of this thesis is to revisit the work of \citeauthor{jepsen2014},
and verify whether recent development improvements in MIP solvers
have made them competitive at solving the pricing problem,
or vice versa,
if the current situation and modern dynamic programming algorithms have
made BAC approaches completely obsolete.



\section{Outline}
\label{sec:intro-outline}

TODO: Introduce the outline of the thesis
